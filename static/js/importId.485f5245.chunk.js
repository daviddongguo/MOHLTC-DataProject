(this["webpackJsonpdata-project"]=this["webpackJsonpdata-project"]||[]).push([[21],{360:function(t,e,n){"use strict";n.d(e,"j",(function(){return u})),n.d(e,"c",(function(){return c.a})),n.d(e,"a",(function(){return i.RichText})),n.d(e,"b",(function(){return f})),n.d(e,"f",(function(){return r})),n.d(e,"l",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return h})),n.d(e,"g",(function(){return v})),n.d(e,"k",(function(){return p})),n.d(e,"i",(function(){return g}));var r,a=n(49),o=n(50),u=new(function(){function t(){Object(a.a)(this,t),this.hooks={}}return Object(o.a)(t,[{key:"add",value:function(t,e){var n=this.hooks[t];n||(n=this.hooks[t]=[]),Array.isArray(e)?e.forEach((function(t){n.push(t)})):n.push(e)}},{key:"remove",value:function(t,e){var n=this.hooks[t];n&&(this.hooks[t]=n.filter((function(t){return t!==e})))}},{key:"clear",value:function(){this.hooks={}}},{key:"invoke",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var a=this.hooks[t];a&&a.forEach((function(t){return t.apply(void 0,n)}))}}]),t}()),i=n(352),c=n.n(i),f=i.FormulaParser.SSF;function s(t){r=t}var l=function(t,e,n,r,a){for(var o=[e,n,r,a],u=n;u<=a;u++){var i=t.getCell(e,u).merged();i&&i.from.row<o[0]&&(o[0]=i.from.row);var c=t.getCell(r,u).merged();c&&c.to.row>o[2]&&(o[2]=c.to.row)}for(var f=e;f<=r;f++){var s=t.getCell(f,n).merged();s&&s.from.col<o[1]&&(o[1]=s.from.col);var l=t.getCell(f,a).merged();l&&l.to.col>o[3]&&(o[3]=l.to.col)}return o};function d(t){if(t)return t.rgb?"System Foreground"===t.rgb?"000000":"System Background"===t.rgb?"ffffff":6===t.rgb.length?t.rgb:t.rgb.substring(2):void 0!==t.theme?r.workbook.theme().themeColor(t.theme,t.tint):void 0}function h(t){return t?"string"===typeof t.formula()?"formula":t.value()instanceof i.RichText?"richtext":t.value()instanceof Date?"date":void 0===t.value()||null===t.value()||"string"===typeof t.value()?"text":typeof t.value():void 0}function v(t){for(var e=t.sheets(),n=e.length+1,r=0;r<e.length;r++){var a=e[r].name().match(/^Sheet(\d+)$/);a&&n<=a[1]&&n++}return"Sheet"+n}function p(t,e){return t?t.sheets().findIndex((function(t){return t.name()===e})):-1}function g(t){return t?t.sheets().map((function(t){return t.name()})):[]}},408:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(278),a=n(49),o=n(50),u=n(168),i=n.n(u),c=n(167),f=n(152),s=null,l=function(){function t(e){var n=this;return Object(a.a)(this,t),this.getAttributeGroup=function(){return n.getGroup(!0)},this.getCategoryGroup=function(){return n.getGroup(!1)},this.updateAttributeGroup=function(t){return n.updateGroup(!0,t)},this.updateCategoryGroup=function(t){return n.updateGroup(!1,t)},this.removeAttributeGroup=function(t){return n.removeGroup(!0,t)},this.removeCategoryGroup=function(t){return n.removeGroup(!1,t)},this.generateObjectId=f.e,s||(s=this,this.props=e),s}return Object(o.a)(t,[{key:"add",value:function(t,e,n,r){var a=t?"attribute":"category";return i.a.post(c.a.server+"/api/v2/"+a,{id:e,name:n,description:r},f.a).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"batchAdd",value:function(t,e){var n=t?"attribute":"category";return i.a.post(c.a.server+"/api/v2/batch/"+n,{data:e},f.a).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"get",value:function(t){var e=t?"attribute":"category";return i.a.get(c.a.server+"/api/v2/"+e,f.a).then((function(t){if(Object(f.c)(t)){for(var e=t.data.data,n=[],r=0;r<e.length;r++){var a=e[r];n.push([a.id,a.name,a.description||"",a._id,a.groups])}return n}}))}},{key:"delete",value:function(t,e){var n=t?"attribute":"category";return i.a.delete(c.a.server+"/api/v2/"+n,{data:{ids:e},withCredentials:f.a.withCredentials}).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"assignGroups",value:function(t,e){var n=t?"attribute":"category";return i.a.post("".concat(c.a.server,"/api/v2/").concat(n,"/assign/group"),e,f.a).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"generateId",value:function(t){var e=t?"attribute":"category";return i.a.get("".concat(c.a.server,"/api/v2/").concat(e,"/generate/id"),f.a).then((function(t){if(Object(f.c)(t))return t.data.id}))}},{key:"getGroup",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"title",r=t?"attribute":"category";return i.a.get("".concat(c.a.server,"/api/v2/").concat(r,"/group"),f.a).then((function(t){if(Object(f.c)(t))return t.data})).then((function(t){return e._buildTree(t.documents,n)}))}},{key:"updateGroup",value:function(t,e){var n=t?"attribute":"category";return i.a.post("".concat(c.a.server,"/api/v2/").concat(n,"/group"),{documents:this._flatTree(e)},f.a).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"removeGroup",value:function(t,e){var n=t?"attribute":"category";return i.a.delete("".concat(c.a.server,"/api/v2/").concat(n,"/group/").concat(e),f.a).then((function(t){if(Object(f.c)(t))return t.data}))}},{key:"_buildTree",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0;if(null==n){var u,i=Object(r.a)(t);try{for(i.s();!(u=i.n()).done;){var c=u.value;if(!c.parent){var f={[e]:c.name,_id:c._id,children:[]};a.push(f),this._buildTree(t,e,f,a,c.children)}}}catch(v){i.e(v)}finally{i.f()}return a}if(0!==o.length){var s,l=Object(r.a)(t);try{for(l.s();!(s=l.n()).done;){var d=s.value;if(o.includes(d._id)){var h={[e]:d.name,_id:d._id,children:[]};n.children.push(h),this._buildTree(t,e,h,a,d.children)}}}catch(v){l.e(v)}finally{l.f()}}}},{key:"_flatTree",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(!n){var o,u=Object(r.a)(t);try{for(u.s();!(o=u.n()).done;){var i=o.value,c={_id:i._id,name:i.title,children:[]};e.push(c),this._flatTree(t,e,i,c)}}catch(h){u.e(h)}finally{u.f()}return e}if(n.children&&0!==n.children.length){var f,s=Object(r.a)(n.children);try{for(s.s();!(f=s.n()).done;){var l=f.value;a.children.push(l._id);var d={_id:l._id,name:l.title,children:[],parent:n._id};e.push(d),this._flatTree(t,e,l,d)}}catch(h){s.e(h)}finally{s.f()}}}}]),t}()},6391:function(t,e){},6517:function(t,e){},6522:function(t,e){},6523:function(t,e){},6532:function(t,e){},6533:function(t,e){},6550:function(t,e){},6554:function(t,e){},6555:function(t,e){},6565:function(t,e){},7310:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return v}));var r=n(125),a=n.n(r),o=n(226),u=n(159),i=n(154),c=n(360),f=n(0),s=n.n(f),l=n(248),d=n(408),h=function(t,e){return function(){var n=document.createElement("input");n.type="file",n.onchange=function(n){var r=n.target.files[0];console.log(r.name),c.c.fromDataAsync(r).then(function(){var n=Object(i.a)(a.a.mark((function n(i){var c,f,s,l,d;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c={},f=[],s=[],i.sheets().forEach((function(t){var e=c[t.name()]={atts:[],cats:[]},n=Object(u.a)(t._rows.entries()).sort((function(t,e){return t[0]-e[0]}));n.forEach((function(n){var a=Object(o.a)(n,2),i=(a[0],a[1]),c=Object(u.a)(i._cells.entries()).sort((function(t,e){return t[0]-e[0]})),s=i.cell(1).getValue();if(/^[0-9]*$/.test(s))for(var l=0;l<c.length;l++){var d=c[l][1];if("string"===typeof d.getValue()){var h={id:Number(s),name:d.getValue(),description:r.name+" > "+t.name()};f.push(h),e.cats.push(h);break}}})),t.row(1)._cells.forEach((function(a,o){var u=a.getValue();if(/^[0-9]*$/.test(u))for(var i=n[n.length-1][0],c=1;c<=i;c++){var f=t.row(c).cell(o).getValue();if("string"===typeof f){var l={id:Number(u),name:f,description:r.name+" > "+t.name()};s.push(l),e.atts.push(l);break}}}))})),console.log(c),n.next=7,t.batchAdd(!0,s);case 7:return l=n.sent.message,n.next=10,t.batchAdd(!1,f);case 10:d=n.sent.message,e(l+"\n"+d,"success");case 12:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},n.click()}};function v(t){var e=new d.a(t);return s.a.createElement(l.a,{variant:"contained",color:"primary",onClick:h(e,t.showMessage)},"Upload Workbook")}}}]);
//# sourceMappingURL=importId.485f5245.chunk.js.map